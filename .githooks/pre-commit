#!/usr/bin/env bash
set -euo pipefail

if ! command -v inkscape >/dev/null 2>&1; then
  echo "[pre-commit] inkscape not found; skipping local PNG render (CI will handle it)." >&2
  exit 0
fi

changed_svgs=$(git diff --cached --name-only -- 'site/assets/*_og.svg' || true)
[ -z "$changed_svgs" ] && exit 0

echo "[pre-commit] Rendering OG PNG sidecarsâ€¦"
for f in $changed_svgs; do
  out="${f%.svg}.png"
  inkscape --export-type=png --export-filename="$out" "$f"
  git add "$out"
done