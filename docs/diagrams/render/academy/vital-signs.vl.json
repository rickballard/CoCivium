{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 900, "height": 420,
  "data": { "values": [
    {"t": 1800, "k":"LifeExpectancy","v": 25},
    {"t": 1900, "k":"LifeExpectancy","v": 31},
    {"t": 2000, "k":"LifeExpectancy","v": 67},
    {"t": 2020, "k":"LifeExpectancy","v": 72},

    {"t": 1800, "k":"Literacy","v": 12},
    {"t": 1900, "k":"Literacy","v": 21},
    {"t": 2000, "k":"Literacy","v": 82},
    {"t": 2020, "k":"Literacy","v": 86},

    {"t": 1800, "k":"ExtremePoverty(1-minus)","v": 5},
    {"t": 1900, "k":"ExtremePoverty(1-minus)","v": 8},
    {"t": 2000, "k":"ExtremePoverty(1-minus)","v": 85},
    {"t": 2020, "k":"ExtremePoverty(1-minus)","v": 92}
  ]},
  "transform": [
    {"aggregate":[{"op":"mean","field":"v","as":"agg"}],"groupby":["t"]},
    {"window":[{"op":"lead","field":"agg","as":"agg_next"}],"sort":[{"field":"t"}]}
  ],
  "layer": [
    {
      "mark": {"type":"line"},
      "encoding": {
        "x": {"field":"t","type":"temporal","title":"Year"},
        "y": {"field":"v","type":"quantitative","title":"Normalized index (0â€“100)", "scale":{"domain":[0,100]}},
        "color": {"field":"k","type":"nominal","title":"Series"},
        "opacity": {"value": 0.6}
      }
    },
    {
      "mark": {"type":"line","strokeWidth": 4},
      "transform":[{"aggregate":[{"op":"mean","field":"v","as":"Vitality"}],"groupby":["t"]}],
      "encoding":{
        "x":{"field":"t","type":"temporal"},
        "y":{"field":"Vitality","type":"quantitative"},
        "color":{"value":"black"}
      }
    }
  ]
}
