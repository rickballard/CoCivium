name: paper-build
on:
  pull_request:
    paths:
      - "docs/papers/academia-shock/**"
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - uses: actions/checkout@v4
      - name: Install pandoc and TeX
        run: |
          sudo apt-get update
          sudo apt-get install -y pandoc texlive-latex-recommended texlive-fonts-recommended texlive-latex-extra
      - name: Build docs
        run: |
          mkdir -p artifacts
          pandoc docs/papers/academia-shock/VIEWPOINT.md -o artifacts/AcademiaShock_Viewpoint.docx --citeproc
          pandoc docs/papers/academia-shock/VIEWPOINT.md -o artifacts/AcademiaShock_Viewpoint.html --standalone --citeproc
          pandoc docs/papers/academia-shock/VIEWPOINT.md -o artifacts/AcademiaShock_Viewpoint.pdf  --pdf-engine=xelatex --citeproc
          pandoc docs/papers/academia-shock/METHODS.md   -o artifacts/AcademiaShock_Methods.docx --citeproc
          pandoc docs/papers/academia-shock/METHODS.md   -o artifacts/AcademiaShock_Methods.html --standalone --citeproc
          pandoc docs/papers/academia-shock/METHODS.md   -o artifacts/AcademiaShock_Methods.pdf  --pdf-engine=xelatex --citeproc
      - name: Upload artifacts
        uses: actions/upload-artifact@v4
        with:
          name: academia-shock-build
          path: artifacts/**